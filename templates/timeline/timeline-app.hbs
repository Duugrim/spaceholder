<div class="sh-tl">
  <header class="sh-tl__header">
    <nav class="sh-tl__views tabs" data-group="sh-tl">
      {{#each views as |v|}}
        <a class="item {{#if v.active}}active{{/if}}" data-action="set-view" data-view="{{v.id}}">{{v.label}}</a>
      {{/each}}
    </nav>

    <div class="sh-tl__controls">
      {{#if showFactionSelect}}
        <select class="sh-tl__select" data-action="select-faction" aria-label="{{localize 'SPACEHOLDER.Timeline.Fields.Faction'}}">
          {{#each factions as |f|}}
            <option value="{{f.uuid}}" {{#if (eq f.uuid @root.activeFactionUuid)}}selected{{/if}}>
              {{f.name}}
            </option>
          {{/each}}
        </select>
      {{/if}}

      {{#if showHiddenToggle}}
        <button
          type="button"
          class="icon-btn sh-tl__iconBtn {{#if showHidden}}is-active{{/if}}"
          data-action="toggle-show-hidden"
          aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleHidden'}}"
          data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleHidden'}}"
        >
          {{#if showHidden}}
            <i class="fa-solid fa-eye" aria-hidden="true"></i>
          {{else}}
            <i class="fa-solid fa-eye-slash" aria-hidden="true"></i>
          {{/if}}
        </button>
      {{/if}}

      {{#if canCreate}}
        <button
          type="button"
          class="icon-btn sh-tl__iconBtn"
          data-action="create-entry"
          aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.Add'}}"
          data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.Add'}}"
        ><i class="fa-solid fa-plus" aria-hidden="true"></i></button>
      {{/if}}
    </div>
  </header>

  <section class="sh-tl__body">
    {{#if loading}}
      <div class="sh-tl__empty">{{localize 'SPACEHOLDER.Timeline.App.Loading'}}</div>
    {{else}}
      {{#if entries.length}}
        <div class="sh-tl__list">
          {{#each entries as |e|}}
            <article
              class="sh-tl__entry {{e.originUiClass}} {{#if e.isHidden}}is-hidden{{/if}} {{#if e.accentColor}}has-accent{{/if}}"
              data-uuid="{{e.uuid}}"
              {{#if e.accentColor}}style="--sh-tl-accent: {{e.accentColor}};{{#if e.accentColorRgb}} --sh-tl-accent-rgb: {{e.accentColorRgb}};{{/if}}"{{/if}}
            >
              <div class="sh-tl__entryHeader" data-action="toggle-expand" data-uuid="{{e.uuid}}">
                <div class="sh-tl__year">{{e.year}}</div>
                <div class="sh-tl__title" title="{{e.title}}">{{e.title}}</div>

                <div class="sh-tl__actions" role="group" aria-label="{{localize 'SPACEHOLDER.Timeline.Groups.Actions'}}">
                  {{#if e.canReorder}}
                    <div class="sh-tl__actionGroup" role="group" aria-label="{{localize 'SPACEHOLDER.Timeline.Groups.Order'}}">
                      <button type="button" class="icon-btn sh-tl__iconBtn" data-action="move-up" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.MoveUp'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.MoveUp'}}">
                        <i class="fa-solid fa-arrow-up" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="icon-btn sh-tl__iconBtn" data-action="move-down" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.MoveDown'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.MoveDown'}}">
                        <i class="fa-solid fa-arrow-down" aria-hidden="true"></i>
                      </button>
                    </div>
                  {{/if}}

                  {{#if e.canToggleGlobal}}
                    <div class="sh-tl__actionGroup" role="group" aria-label="{{localize 'SPACEHOLDER.Timeline.Groups.Visibility'}}">
                      <button type="button" class="icon-btn sh-tl__iconBtn {{e.globalUiClass}}" data-action="toggle-global" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleGlobal'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleGlobal'}}">
                        <i class="fa-solid fa-globe" aria-hidden="true"></i>
                      </button>
                      {{#if e.canToggleHidden}}
                        <button type="button" class="icon-btn sh-tl__iconBtn {{#if e.isHidden}}is-active{{/if}}" data-action="toggle-hidden" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleHidden'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleHidden'}}">
                          <i class="fa-solid fa-eye-slash" aria-hidden="true"></i>
                        </button>
                      {{/if}}
                    </div>
                  {{else}}
                    {{#if e.canToggleHidden}}
                      <div class="sh-tl__actionGroup" role="group" aria-label="{{localize 'SPACEHOLDER.Timeline.Groups.Visibility'}}">
                        <button type="button" class="icon-btn sh-tl__iconBtn {{#if e.isHidden}}is-active{{/if}}" data-action="toggle-hidden" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleHidden'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.ToggleHidden'}}">
                          <i class="fa-solid fa-eye-slash" aria-hidden="true"></i>
                        </button>
                      </div>
                    {{/if}}
                  {{/if}}

                  {{#if e.canEdit}}
                    <div class="sh-tl__actionGroup" role="group" aria-label="{{localize 'SPACEHOLDER.Timeline.Groups.Editing'}}">
                      <button type="button" class="icon-btn sh-tl__iconBtn" data-action="edit-entry" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.Edit'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.Edit'}}">
                        <i class="fa-solid fa-pen" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="icon-btn sh-tl__iconBtn danger" data-action="delete-entry" data-uuid="{{e.uuid}}" aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.Delete'}}" data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.Delete'}}">
                        <i class="fa-solid fa-trash" aria-hidden="true"></i>
                      </button>
                    </div>
                  {{/if}}

                  <div class="sh-tl__actionGroup" role="group" aria-label="{{localize 'SPACEHOLDER.Timeline.Groups.Content'}}">
                    <button
                      type="button"
                      class="icon-btn sh-tl__iconBtn"
                      data-action="toggle-expand"
                      data-uuid="{{e.uuid}}"
                      aria-label="{{localize 'SPACEHOLDER.Timeline.Buttons.Expand'}}"
                      data-tooltip="{{localize 'SPACEHOLDER.Timeline.Buttons.Expand'}}"
                    >
                      {{#if e.isExpanded}}
                        <i class="fa-solid fa-chevron-up" aria-hidden="true"></i>
                      {{else}}
                        <i class="fa-solid fa-chevron-down" aria-hidden="true"></i>
                      {{/if}}
                    </button>
                  </div>
                </div>
              </div>

              {{#if e.isExpanded}}
                <div class="sh-tl__content">{{{e.enrichedContent}}}</div>
              {{/if}}
            </article>
          {{/each}}
        </div>
      {{else}}
        <div class="sh-tl__empty">{{localize 'SPACEHOLDER.Timeline.App.EmptyState'}}</div>
      {{/if}}
    {{/if}}
  </section>
</div>
